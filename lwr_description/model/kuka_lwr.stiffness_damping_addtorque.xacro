<?xml version="1.0"?>

<robot xmlns:xacro="http://ros.org/wiki/xacro">

	<xacro:property name="max_stiffness" value="2000"/>
	<xacro:property name="min_stiffness" value="0.01"/>
	<xacro:property name="rate_stiffness" value="20000"/> <!-- reflex to stiffness -->

	<xacro:property name="max_damping" value="1.0"/>
	<xacro:property name="min_damping" value="0.1"/>
	<xacro:property name="rate_damping" value="4.0"/> <!-- reflex to damping -->

	<xacro:property name="max_add_torqueA12" value="80.0"/>
	<xacro:property name="min_add_torqueA12" value="-80.0"/>
	<xacro:property name="max_add_torqueE1A34" value="80.0"/>
	<xacro:property name="min_add_torqueE1A34" value="-80.0"/>
	<xacro:property name="max_add_torqueA56" value="80.0"/>
	<xacro:property name="min_add_torqueA56" value="-80.0"/>
	<xacro:property name="rate_add_torque" value="8.0"/> <!-- reflex to additional torque -->

	<xacro:macro name="kuka_lwr_stiffness_damping_addtorque" params="name">

		<joint name="${name}_a1_joint_stiffness" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_stiffness}" upper="${max_stiffness}" effort="0" velocity="${rate_stiffness}" />
			<safety_controller soft_lower_limit="${min_stiffness}" soft_upper_limit="${max_stiffness}" k_position="30" k_velocity="30"/>
			<parent link="${name}_base_link"/>
			<child link="${name}_1_link_dummy"/>
		</joint>
		<link name="${name}_1_link_dummy"/>


		<joint name="${name}_a2_joint_stiffness" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_stiffness}" upper="${max_stiffness}" effort="0" velocity="${rate_stiffness}" />
			<safety_controller soft_lower_limit="${min_stiffness}" soft_upper_limit="${max_stiffness}" k_position="30" k_velocity="30"/>
			<parent link="${name}_1_link"/>
			<child link="${name}_2_link_dummy"/>
		</joint>
		<link name="${name}_2_link_dummy"/>


		<joint name="${name}_e1_joint_stiffness" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_stiffness}" upper="${max_stiffness}" effort="0" velocity="${rate_stiffness}" />
			<safety_controller soft_lower_limit="${min_stiffness}" soft_upper_limit="${max_stiffness}" k_position="30" k_velocity="30"/>
			<parent link="${name}_2_link"/>
			<child link="${name}_3_link_dummy"/>
		</joint>
		<link name="${name}_3_link_dummy"/>


		<joint name="${name}_a3_joint_stiffness" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_stiffness}" upper="${max_stiffness}" effort="0" velocity="${rate_stiffness}" />
			<safety_controller soft_lower_limit="${min_stiffness}" soft_upper_limit="${max_stiffness}" k_position="30" k_velocity="30"/>
			<parent link="${name}_3_link"/>
			<child link="${name}_4_link_dummy"/>
		</joint>
		<link name="${name}_4_link_dummy"/>


		<joint name="${name}_a4_joint_stiffness" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_stiffness}" upper="${max_stiffness}" effort="0" velocity="${rate_stiffness}" />
			<safety_controller soft_lower_limit="${min_stiffness}" soft_upper_limit="${max_stiffness}" k_position="30" k_velocity="30"/>
			<parent link="${name}_4_link"/>
			<child link="${name}_5_link_dummy"/>
		</joint>
		<link name="${name}_5_link_dummy"/>


		<joint name="${name}_a5_joint_stiffness" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_stiffness}" upper="${max_stiffness}" effort="0" velocity="${rate_stiffness}" />
			<safety_controller soft_lower_limit="${min_stiffness}" soft_upper_limit="${max_stiffness}" k_position="30" k_velocity="30"/>
			<parent link="${name}_5_link"/>
			<child link="${name}_6_link_dummy"/>
		</joint>
		<link name="${name}_6_link_dummy"/>


		<joint name="${name}_a6_joint_stiffness" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_stiffness}" upper="${max_stiffness}" effort="0" velocity="${rate_stiffness}" />
			<safety_controller soft_lower_limit="${min_stiffness}" soft_upper_limit="${max_stiffness}" k_position="30" k_velocity="30"/>
			<parent link="${name}_6_link"/>
			<child link="${name}_7_link_dummy"/>
		</joint>
		<link name="${name}_7_link_dummy"/>

		<!-- fake stuff for damping and set_point -->
		<joint name="${name}_a1_joint_add_torque" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_add_torqueA12}" upper="${max_add_torqueA12}" effort="0" velocity="${rate_add_torque}" />
			<safety_controller soft_lower_limit="${min_add_torqueA12}" soft_upper_limit="${max_add_torqueA12}" k_position="30" k_velocity="30"/>
			<parent link="${name}_base_link"/>
			<child link="${name}_1_link_dummy_add_torque"/>
		</joint>
		<link name="${name}_1_link_dummy_add_torque"/>

		<joint name="${name}_a2_joint_add_torque" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_add_torqueA12}" upper="${max_add_torqueA12}" effort="0" velocity="${rate_add_torque}" />
			<safety_controller soft_lower_limit="${min_add_torqueA12}" soft_upper_limit="${max_add_torqueA12}" k_position="30" k_velocity="30"/>
			<parent link="${name}_1_link"/>
			<child link="${name}_2_link_dummy_add_torque"/>
		</joint>
		<link name="${name}_2_link_dummy_add_torque"/>

		<joint name="${name}_e1_joint_add_torque" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_add_torqueE1A34}" upper="${max_add_torqueE1A34}" effort="0" velocity="${rate_add_torque}" />
			<safety_controller soft_lower_limit="${min_add_torqueE1A34}" soft_upper_limit="${max_add_torqueE1A34}" k_position="30" k_velocity="30"/>
			<parent link="${name}_2_link"/>
			<child link="${name}_3_link_dummy_add_torque"/>
		</joint>
		<link name="${name}_3_link_dummy_add_torque"/>

		<joint name="${name}_a3_joint_add_torque" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_add_torqueE1A34}" upper="${max_add_torqueE1A34}" effort="0" velocity="${rate_add_torque}" />
			<safety_controller soft_lower_limit="${min_add_torqueE1A34}" soft_upper_limit="${max_add_torqueE1A34}" k_position="30" k_velocity="30"/>
			<parent link="${name}_3_link"/>
			<child link="${name}_4_link_dummy_add_torque"/>
		</joint>
		<link name="${name}_4_link_dummy_add_torque"/>

		<joint name="${name}_a4_joint_add_torque" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_add_torqueE1A34}" upper="${max_add_torqueE1A34}" effort="0" velocity="${rate_add_torque}" />
			<safety_controller soft_lower_limit="${min_add_torqueE1A34}" soft_upper_limit="${max_add_torqueE1A34}" k_position="30" k_velocity="30"/>
			<parent link="${name}_4_link"/>
			<child link="${name}_5_link_dummy_add_torque"/>
		</joint>
		<link name="${name}_5_link_dummy_add_torque"/>

		<joint name="${name}_a5_joint_add_torque" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_add_torqueA56}" upper="${max_add_torqueA56}" effort="0" velocity="${rate_add_torque}" />
			<safety_controller soft_lower_limit="${min_add_torqueA56}" soft_upper_limit="${max_add_torqueA56}" k_position="30" k_velocity="30"/>
			<parent link="${name}_5_link"/>
			<child link="${name}_6_link_dummy_add_torque"/>
		</joint>
		<link name="${name}_6_link_dummy_add_torque"/>

		<joint name="${name}_a6_joint_add_torque" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_add_torqueA56}" upper="${max_add_torqueA56}" effort="0" velocity="${rate_add_torque}" />
			<safety_controller soft_lower_limit="${min_add_torqueA56}" soft_upper_limit="${max_add_torqueA56}" k_position="30" k_velocity="30"/>
			<parent link="${name}_6_link"/>
			<child link="${name}_7_link_dummy_add_torque"/>
		</joint>
		<link name="${name}_7_link_dummy_add_torque"/>

		<joint name="${name}_a1_joint_damping" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_damping}" upper="${max_damping}" effort="0" velocity="${rate_damping}" />
			<safety_controller soft_lower_limit="${min_damping}" soft_upper_limit="${max_damping}" k_position="30" k_velocity="30"/>
			<parent link="${name}_base_link"/>
			<child link="${name}_1_link_dummy_damping"/>
		</joint>
		<link name="${name}_1_link_dummy_damping"/>

		<joint name="${name}_a2_joint_damping" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_damping}" upper="${max_damping}" effort="0" velocity="${rate_damping}" />
			<safety_controller soft_lower_limit="${min_damping}" soft_upper_limit="${max_damping}" k_position="30" k_velocity="30"/>
			<parent link="${name}_1_link"/>
			<child link="${name}_2_link_dummy_damping"/>
		</joint>
		<link name="${name}_2_link_dummy_damping"/>

		<joint name="${name}_e1_joint_damping" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_damping}" upper="${max_damping}" effort="0" velocity="${rate_damping}" />
			<safety_controller soft_lower_limit="${min_damping}" soft_upper_limit="${max_damping}" k_position="30" k_velocity="30"/>
			<parent link="${name}_2_link"/>
			<child link="${name}_3_link_dummy_damping"/>
		</joint>
		<link name="${name}_3_link_dummy_damping"/>

		<joint name="${name}_a3_joint_damping" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_damping}" upper="${max_damping}" effort="0" velocity="${rate_damping}" />
			<safety_controller soft_lower_limit="${min_damping}" soft_upper_limit="${max_damping}" k_position="30" k_velocity="30"/>
			<parent link="${name}_3_link"/>
			<child link="${name}_4_link_dummy_damping"/>
		</joint>
		<link name="${name}_4_link_dummy_damping"/>

		<joint name="${name}_a4_joint_damping" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_damping}" upper="${max_damping}" effort="0" velocity="${rate_damping}" />
			<safety_controller soft_lower_limit="${min_damping}" soft_upper_limit="${max_damping}" k_position="30" k_velocity="30"/>
			<parent link="${name}_4_link"/>
			<child link="${name}_5_link_dummy_damping"/>
		</joint>
		<link name="${name}_5_link_dummy_damping"/>

		<joint name="${name}_a5_joint_damping" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_damping}" upper="${max_damping}" effort="0" velocity="${rate_damping}" />
			<safety_controller soft_lower_limit="${min_damping}" soft_upper_limit="${max_damping}" k_position="30" k_velocity="30"/>
			<parent link="${name}_5_link"/>
			<child link="${name}_6_link_dummy_damping"/>
		</joint>
		<link name="${name}_6_link_dummy_damping"/>

		<joint name="${name}_a6_joint_damping" type="revolute">
			<axis xyz="0 0 1"/>
			<limit lower="${min_damping}" upper="${max_damping}" effort="0" velocity="${rate_damping}" />
			<safety_controller soft_lower_limit="${min_damping}" soft_upper_limit="${max_damping}" k_position="30" k_velocity="30"/>
			<parent link="${name}_6_link"/>
			<child link="${name}_7_link_dummy_damping"/>
		</joint>
		<link name="${name}_7_link_dummy_damping"/>

	</xacro:macro>

</robot>